
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Block program as a standalone solver &#8212; BLOCK 1.5.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinxdoc.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Keywords" href="keywords.html" />
    <link rel="prev" title="DMRG for electronic structure calculations" href="with-pyscf.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="keywords.html" title="Keywords"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="with-pyscf.html" title="DMRG for electronic structure calculations"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">BLOCK 1.5.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Block program as a standalone solver</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="block-program-as-a-standalone-solver">
<span id="standalone"></span><h1>Block program as a standalone solver<a class="headerlink" href="#block-program-as-a-standalone-solver" title="Permalink to this headline">¶</a></h1>
<p>In the following DMRG calculation, C<sub>2</sub> molecule is used to demonstrate various computational features as of the 1.5.0 release.
Integrals and orbitals must be supplied externally in
<a class="reference external" href="http://www.molpro.net/info/2010.1/doc/manual/node417.html">Molpro’s FCIDUMP format</a>.
The integral files for C<sub>2</sub> can be found here: <a class="reference external" href="https://raw.githubusercontent.com/sanshar/Block/master/README_Examples/FCIDUMP">FCIDUMP</a>
or generated by the PySCF script:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span><span class="p">,</span> <span class="n">dmrgscf</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;C 0 0 0; C 0 0 1.2425&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">,</span> <span class="n">symmetry</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASCI</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span> <span class="o">=</span> <span class="n">dmrgscf</span><span class="o">.</span><span class="n">DMRGCI</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">dmrgscf</span><span class="o">.</span><span class="n">dryrun</span><span class="p">(</span><span class="n">mc</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="molecular-symmetry">
<h2>Molecular symmetry<a class="headerlink" href="#molecular-symmetry" title="Permalink to this headline">¶</a></h2>
<p>Example 1: <code class="docutils literal notranslate"><span class="pre">BLOCK</span></code> input with the default settings for the ground state energy:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span> <span class="n">d2h</span>
<span class="n">orbitals</span> <span class="n">FCIDUMP</span>

<span class="n">nelec</span> <span class="mi">8</span>
<span class="n">spin</span> <span class="mi">0</span>
<span class="n">irrep</span> <span class="mi">1</span>

<span class="n">hf_occ</span> <span class="n">integral</span>
<span class="n">schedule</span> <span class="n">default</span>
<span class="n">maxM</span> <span class="mi">500</span>
<span class="n">maxiter</span> <span class="mi">30</span>
</pre></div>
</div>
<p>D<sub>2h</sub> symmetry is enabled by <code class="docutils literal notranslate"><span class="pre">sym</span> <span class="pre">d2h</span></code>.
The simplest option is to take <code class="docutils literal notranslate"><span class="pre">schedule</span> <span class="pre">default</span></code> and the maximum number of renormalized states, <code class="docutils literal notranslate"><span class="pre">maxM</span></code>.
<code class="docutils literal notranslate"><span class="pre">BLOCK</span></code> will then automatically choose a sweep schedule as well as set defaults for various tolerances.</p>
<p>The discarded weights and associated sweep energies can be extracted by grepping <code class="docutils literal notranslate"><span class="pre">output.dat</span></code>, for instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ grep &quot;Sweep Energy&quot; output.dat
M = 250     state = 0     Largest Discarded Weight = 2.601e-05  Sweep Energy = -75.7044175965
M = 250     state = 0     Largest Discarded Weight = 4.145e-05  Sweep Energy = -75.7253836704
M = 250     state = 0     Largest Discarded Weight = 5.085e-05  Sweep Energy = -75.7268081556
M = 250     state = 0     Largest Discarded Weight = 5.615e-05  Sweep Energy = -75.7271779408
M = 250     state = 0     Largest Discarded Weight = 5.769e-05  Sweep Energy = -75.7272098184
M = 250     state = 0     Largest Discarded Weight = 5.568e-05  Sweep Energy = -75.7273283072
M = 250     state = 0     Largest Discarded Weight = 5.712e-05  Sweep Energy = -75.7273267274
M = 250     state = 0     Largest Discarded Weight = 5.517e-05  Sweep Energy = -75.7273439451
M = 500     state = 0     Largest Discarded Weight = 1.441e-05  Sweep Energy = -75.7278969832
M = 500     state = 0     Largest Discarded Weight = 1.504e-05  Sweep Energy = -75.7281427759
M = 500     state = 0     Largest Discarded Weight = 3.768e-06  Sweep Energy = -75.7282950558
M = 500     state = 0     Largest Discarded Weight = 4.737e-06  Sweep Energy = -75.7283534344
M = 500     state = 0     Largest Discarded Weight = 4.602e-13  Sweep Energy = -75.7283427167
M = 500     state = 0     Largest Discarded Weight = 8.882e-16  Sweep Energy = -75.7283455434
M = 500     state = 0     Largest Discarded Weight = 3.689e-13  Sweep Energy = -75.7283467279
</pre></div>
</div>
</div>
<div class="section" id="state-wavefunction">
<h2>State wavefunction<a class="headerlink" href="#state-wavefunction" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">BLOCK</span></code> can target the states distinguished by the number of electrons <code class="docutils literal notranslate"><span class="pre">nelec</span></code>, the total spin <code class="docutils literal notranslate"><span class="pre">spin</span></code> and the point-group symmetry of the state <code class="docutils literal notranslate"><span class="pre">irrep</span></code>.</p>
<p>Example 2: a single B<sub>1g</sub> state in D<sub>2h</sub>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span> <span class="n">d2h</span>
<span class="n">orbitals</span> <span class="n">FCIDUMP</span>

<span class="n">nelec</span> <span class="mi">8</span>
<span class="n">spin</span> <span class="mi">0</span>
<span class="n">irrep</span> <span class="mi">4</span>

<span class="n">hf_occ</span> <span class="n">integral</span>
<span class="n">schedule</span> <span class="n">default</span>
<span class="n">maxM</span> <span class="mi">500</span>
<span class="n">maxiter</span> <span class="mi">30</span>
</pre></div>
</div>
<p>Extract energies running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ grep &quot;Sweep Energy&quot; output.dat
M = 250     state = 0     Largest Discarded Weight = 2.074e-05  Sweep Energy = -75.5487622154
M = 250     state = 0     Largest Discarded Weight = 2.572e-05  Sweep Energy = -75.6216559252
M = 250     state = 0     Largest Discarded Weight = 3.001e-05  Sweep Energy = -75.6377863834
M = 250     state = 0     Largest Discarded Weight = 3.869e-05  Sweep Energy = -75.6380712454
M = 250     state = 0     Largest Discarded Weight = 3.410e-05  Sweep Energy = -75.6381445876
M = 250     state = 0     Largest Discarded Weight = 3.936e-05  Sweep Energy = -75.6381956325
M = 250     state = 0     Largest Discarded Weight = 3.597e-05  Sweep Energy = -75.6381986704
M = 250     state = 0     Largest Discarded Weight = 3.956e-05  Sweep Energy = -75.6382158943
M = 500     state = 0     Largest Discarded Weight = 4.035e-06  Sweep Energy = -75.6386091307
M = 500     state = 0     Largest Discarded Weight = 9.904e-06  Sweep Energy = -75.6387867388
M = 500     state = 0     Largest Discarded Weight = 1.011e-06  Sweep Energy = -75.6388951005
M = 500     state = 0     Largest Discarded Weight = 1.909e-06  Sweep Energy = -75.6389530440
M = 500     state = 0     Largest Discarded Weight = 8.626e-14  Sweep Energy = -75.6389616714
M = 500     state = 0     Largest Discarded Weight = 7.772e-16  Sweep Energy = -75.6389641931
M = 500     state = 0     Largest Discarded Weight = 8.882e-16  Sweep Energy = -75.6389650943
M = 500     state = 0     Largest Discarded Weight = 1.332e-15  Sweep Energy = -75.6389656999
M = 500     state = 0     Largest Discarded Weight = 8.882e-16  Sweep Energy = -75.6389659838
</pre></div>
</div>
</div>
<div class="section" id="state-averaged-calculation">
<h2>State-averaged calculation<a class="headerlink" href="#state-averaged-calculation" title="Permalink to this headline">¶</a></h2>
<p>A state-averaged DMRG is available in <code class="docutils literal notranslate"><span class="pre">BLOCK</span></code> for which more than a single state can be targeted in the same calculation.
Currently the states being calculated must be of the same irrep.
The number of roots and the weight of each state can be specified by <code class="docutils literal notranslate"><span class="pre">nroots</span></code> and <code class="docutils literal notranslate"><span class="pre">weights</span></code>, respectively.</p>
<p>Example 3: a state-averaged DMRG of two A<sub>g</sub> states in D<sub>2h</sub>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span> <span class="n">d2h</span>
<span class="n">orbitals</span> <span class="n">FCIDUMP</span>

<span class="n">nelec</span> <span class="mi">8</span>
<span class="n">spin</span> <span class="mi">0</span>
<span class="n">irrep</span> <span class="mi">1</span>
<span class="n">nroots</span> <span class="mi">2</span>
<span class="n">weights</span> <span class="mf">0.5</span> <span class="mf">0.5</span>

<span class="n">hf_occ</span> <span class="n">integral</span>
<span class="n">schedule</span> <span class="n">default</span>
<span class="n">maxM</span> <span class="mi">500</span>
<span class="n">maxiter</span> <span class="mi">30</span>
</pre></div>
</div>
<p>Extract energies running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ grep &quot;Sweep Energy&quot; output.dat
M = 250     state = 0     Largest Discarded Weight = 3.301e-05  Sweep Energy = -75.6977658954
M = 250     state = 1     Largest Discarded Weight = 3.301e-05  Sweep Energy = -75.6097171207
M = 250     state = 0     Largest Discarded Weight = 1.210e-04  Sweep Energy = -75.7242895778
M = 250     state = 1     Largest Discarded Weight = 1.210e-04  Sweep Energy = -75.6351366904
M = 250     state = 0     Largest Discarded Weight = 7.977e-05  Sweep Energy = -75.7258318951
M = 250     state = 1     Largest Discarded Weight = 7.977e-05  Sweep Energy = -75.6364792592
M = 250     state = 0     Largest Discarded Weight = 1.510e-04  Sweep Energy = -75.7262492462
M = 250     state = 1     Largest Discarded Weight = 1.510e-04  Sweep Energy = -75.6369788516
M = 250     state = 0     Largest Discarded Weight = 8.775e-05  Sweep Energy = -75.7262820781
M = 250     state = 1     Largest Discarded Weight = 8.775e-05  Sweep Energy = -75.6369957594
M = 250     state = 0     Largest Discarded Weight = 1.508e-04  Sweep Energy = -75.7263169403
M = 250     state = 1     Largest Discarded Weight = 1.508e-04  Sweep Energy = -75.6370412456
M = 250     state = 0     Largest Discarded Weight = 8.819e-05  Sweep Energy = -75.7263181429
M = 250     state = 1     Largest Discarded Weight = 8.819e-05  Sweep Energy = -75.6370413712
M = 250     state = 0     Largest Discarded Weight = 1.507e-04  Sweep Energy = -75.7263184125
M = 250     state = 1     Largest Discarded Weight = 1.507e-04  Sweep Energy = -75.6370456106
M = 500     state = 0     Largest Discarded Weight = 2.841e-05  Sweep Energy = -75.7274562077
M = 500     state = 1     Largest Discarded Weight = 2.841e-05  Sweep Energy = -75.6382052116
M = 500     state = 0     Largest Discarded Weight = 4.424e-05  Sweep Energy = -75.7277476086
M = 500     state = 1     Largest Discarded Weight = 4.424e-05  Sweep Energy = -75.6385132723
M = 500     state = 0     Largest Discarded Weight = 1.542e-05  Sweep Energy = -75.7279342967
M = 500     state = 1     Largest Discarded Weight = 1.542e-05  Sweep Energy = -75.6386584359
M = 500     state = 0     Largest Discarded Weight = 2.401e-05  Sweep Energy = -75.7279737606
M = 500     state = 1     Largest Discarded Weight = 2.401e-05  Sweep Energy = -75.6386894476
M = 500     state = 0     Largest Discarded Weight = 1.109e-05  Sweep Energy = -75.7279250579
M = 500     state = 1     Largest Discarded Weight = 1.109e-05  Sweep Energy = -75.6386605282
M = 500     state = 0     Largest Discarded Weight = 1.408e-05  Sweep Energy = -75.7279222935
M = 500     state = 1     Largest Discarded Weight = 1.408e-05  Sweep Energy = -75.6386563064
M = 500     state = 0     Largest Discarded Weight = 8.824e-06  Sweep Energy = -75.7279257860
M = 500     state = 1     Largest Discarded Weight = 8.824e-06  Sweep Energy = -75.6386550817
M = 500     state = 0     Largest Discarded Weight = 1.389e-05  Sweep Energy = -75.7279257093
M = 500     state = 1     Largest Discarded Weight = 1.389e-05  Sweep Energy = -75.6386552913
M = 500     state = 0     Largest Discarded Weight = 8.724e-06  Sweep Energy = -75.7279265042
M = 500     state = 1     Largest Discarded Weight = 8.724e-06  Sweep Energy = -75.6386566145
</pre></div>
</div>
</div>
<div class="section" id="state-specific-calculation">
<h2>State-specific calculation<a class="headerlink" href="#state-specific-calculation" title="Permalink to this headline">¶</a></h2>
<p>The state-specific calculation is implemented as a restart calculation which assumes
that a previous DMRG (e.g., state-average) calculation has been converged.
The state-specific DMRG calculation of <code class="docutils literal notranslate"><span class="pre">BLOCK</span></code> then takes these wave functions and refines them for each root separately.
Currently only “onedot” algorithm is implemented for a state-specific DMRG calculation.</p>
<p>Example 4: a state-specific DMRG of two A<sub>g</sub> states consists of two steps.</p>
<ul>
<li><p>First, obtain state-averaged wavefunctions as carried out in Example 3.</p></li>
<li><p>Second, perform the state-specific DMRG calculation by specifying <code class="docutils literal notranslate"><span class="pre">statespecific</span></code> along with algorithm, reading the previous DMRG wavefunction:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span> <span class="n">d2h</span>
<span class="n">orbitals</span> <span class="n">FCIDUMP</span>

<span class="n">nelec</span> <span class="mi">8</span>
<span class="n">spin</span> <span class="mi">0</span>
<span class="n">irrep</span> <span class="mi">1</span>
<span class="n">nroots</span> <span class="mi">2</span>
<span class="n">weights</span> <span class="mf">0.5</span> <span class="mf">0.5</span>
<span class="n">onedot</span>
<span class="n">statespecific</span>

<span class="n">hf_occ</span> <span class="n">integral</span>
<span class="n">schedule</span> <span class="n">default</span>
<span class="n">maxM</span> <span class="mi">500</span>
<span class="n">maxiter</span> <span class="mi">30</span>
</pre></div>
</div>
</li>
</ul>
<p>Extract energies running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ grep &quot;Sweep Energy&quot; output.dat
M = 250     state = 0     Largest Discarded Weight = 1.074e-04  Sweep Energy = -75.7278258618
M = 250     state = 0     Largest Discarded Weight = 6.265e-05  Sweep Energy = -75.7271218843
M = 250     state = 0     Largest Discarded Weight = 7.364e-05  Sweep Energy = -75.7269947744
M = 250     state = 0     Largest Discarded Weight = 5.524e-05  Sweep Energy = -75.7269943736
M = 250     state = 0     Largest Discarded Weight = 7.321e-05  Sweep Energy = -75.7269691045
M = 250     state = 0     Largest Discarded Weight = 5.323e-05  Sweep Energy = -75.7269678846
M = 250     state = 0     Largest Discarded Weight = 7.223e-05  Sweep Energy = -75.7269635922
M = 500     state = 0     Largest Discarded Weight = 2.184e-05  Sweep Energy = -75.7272771612
M = 500     state = 0     Largest Discarded Weight = 3.572e-05  Sweep Energy = -75.7276387065
M = 500     state = 0     Largest Discarded Weight = 9.265e-13  Sweep Energy = -75.7279934002
M = 500     state = 0     Largest Discarded Weight = 4.463e-13  Sweep Energy = -75.7280861611
M = 500     state = 0     Largest Discarded Weight = 5.551e-16  Sweep Energy = -75.7281187446
M = 500     state = 0     Largest Discarded Weight = 9.370e-14  Sweep Energy = -75.7281327072
M = 500     state = 0     Largest Discarded Weight = 3.331e-16  Sweep Energy = -75.7281397782
M = 500     state = 0     Largest Discarded Weight = 9.248e-14  Sweep Energy = -75.7281445745
M = 500     state = 0     Largest Discarded Weight = 6.661e-16  Sweep Energy = -75.7281474895
M = 500     state = 0     Largest Discarded Weight = 9.992e-16  Sweep Energy = -75.7281493387
M = 250     state = 1     Largest Discarded Weight = 8.564e-05  Sweep Energy = -75.6385347218
M = 250     state = 1     Largest Discarded Weight = 5.385e-05  Sweep Energy = -75.6380963835
M = 250     state = 1     Largest Discarded Weight = 6.158e-05  Sweep Energy = -75.6380128961
M = 250     state = 1     Largest Discarded Weight = 4.984e-05  Sweep Energy = -75.6380120359
M = 250     state = 1     Largest Discarded Weight = 5.948e-05  Sweep Energy = -75.6379881607
M = 250     state = 1     Largest Discarded Weight = 4.954e-05  Sweep Energy = -75.6379876616
M = 250     state = 1     Largest Discarded Weight = 6.004e-05  Sweep Energy = -75.6379771996
M = 500     state = 1     Largest Discarded Weight = 2.159e-05  Sweep Energy = -75.6382108002
M = 500     state = 1     Largest Discarded Weight = 2.180e-05  Sweep Energy = -75.6385015895
M = 500     state = 1     Largest Discarded Weight = 4.491e-13  Sweep Energy = -75.6387780117
M = 500     state = 1     Largest Discarded Weight = 6.379e-13  Sweep Energy = -75.6388358995
M = 500     state = 1     Largest Discarded Weight = 1.465e-13  Sweep Energy = -75.6388549910
M = 500     state = 1     Largest Discarded Weight = 7.405e-14  Sweep Energy = -75.6388647713
M = 500     state = 1     Largest Discarded Weight = 1.107e-13  Sweep Energy = -75.6388699886
M = 500     state = 1     Largest Discarded Weight = 1.809e-13  Sweep Energy = -75.6388729422
M = 500     state = 1     Largest Discarded Weight = 2.220e-16  Sweep Energy = -75.6388750897
M = 500     state = 1     Largest Discarded Weight = 6.661e-16  Sweep Energy = -75.6388767670
</pre></div>
</div>
</div>
<div class="section" id="n-particle-reduced-density-matrix">
<h2><em>n</em>-particle reduced density matrix<a class="headerlink" href="#n-particle-reduced-density-matrix" title="Permalink to this headline">¶</a></h2>
<p>The DMRG reduced density matrix up to the 4-particle type for a particular state can be obtained
by employing the keywords <code class="docutils literal notranslate"><span class="pre">onepdm</span></code>, <code class="docutils literal notranslate"><span class="pre">twopdm</span></code>, <code class="docutils literal notranslate"><span class="pre">threepdm</span></code> and <code class="docutils literal notranslate"><span class="pre">fourpdm</span></code>.
Currently only “onedot” algorithm is implemented for this type of calculation.
Density matrices of the <em>n</em>-th state are calculated and stored in a text file named <em>spatial_onepdm.n.n.txt</em>, <em>spatial_twopdm.n.n.txt</em>,
<em>spatial_threepdm.n.n.txt</em> and <em>spatial_fourpdm.n.n.txt</em>, respectively, starting with <cite>n=0</cite>.</p>
<p>Example 5: 2-particle density matrix for the ground state:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span> <span class="n">d2h</span>
<span class="n">orbitals</span> <span class="n">FCIDUMP</span>

<span class="n">nelec</span> <span class="mi">8</span>
<span class="n">spin</span> <span class="mi">0</span>
<span class="n">irrep</span> <span class="mi">1</span>

<span class="n">hf_occ</span> <span class="n">integral</span>
<span class="n">schedule</span> <span class="n">default</span>
<span class="n">maxM</span> <span class="mi">500</span>
<span class="n">maxiter</span> <span class="mi">30</span>

<span class="n">twopdm</span>
</pre></div>
</div>
<p>The 2-particle density matrix is stored in the file of <a class="reference external" href="https://raw.githubusercontent.com/sanshar/Block/master/README_Examples/5/spatial_twopdm.0.0.txt">spatial_twopdm.0.0.txt</a>.</p>
<p>Example 6: state-averaged 2-particle density matrix for two roots:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span> <span class="n">d2h</span>
<span class="n">orbitals</span> <span class="n">FCIDUMP</span>

<span class="n">nelec</span> <span class="mi">8</span>
<span class="n">spin</span> <span class="mi">0</span>
<span class="n">irrep</span> <span class="mi">1</span>
<span class="n">nroots</span> <span class="mi">2</span>
<span class="n">weights</span> <span class="mf">0.5</span> <span class="mf">0.5</span>

<span class="n">hf_occ</span> <span class="n">integral</span>
<span class="n">schedule</span> <span class="n">default</span>
<span class="n">maxM</span> <span class="mi">500</span>
<span class="n">maxiter</span> <span class="mi">30</span>

<span class="n">twopdm</span>
</pre></div>
</div>
<p>The 2-particle density matrices for both state 1 and state 2 are stored in the files of
<a class="reference external" href="https://raw.githubusercontent.com/sanshar/Block/master/README_Examples/6/spatial_twopdm.0.0.txt">spatial_twopdm.0.0.txt</a>,
and <a class="reference external" href="https://raw.githubusercontent.com/sanshar/Block/master/README_Examples/6/spatial_twopdm.1.1.txt">spatial_twopdm.1.1.txt</a>, respectively.</p>
</div>
<div class="section" id="and-2-particle-transition-reduced-density-matrix">
<h2>1- and 2-particle transition reduced density matrix<a class="headerlink" href="#and-2-particle-transition-reduced-density-matrix" title="Permalink to this headline">¶</a></h2>
<p>1-particle and 2-particle transition density matrices can be calculated using the keyword <code class="docutils literal notranslate"><span class="pre">tran_onepdm</span></code> and <code class="docutils literal notranslate"><span class="pre">tran_twopdm</span></code>.
Transition density matrices between the <em>m</em>-th and <em>n</em>-th states are calculated and stored in a text file named <em>spatial_onepdm.m.n.txt</em>
and <em>spatial_twopdm.m.n.txt</em>, respectively, starting with <cite>m=1</cite> and <cite>n=0</cite>.</p>
<p>The transition density matrices between states with different symmetry irreducible presentations are also available.
However, this type of calculation requires multiple steps and the manipulation of scratch files
and will be discussed in <a class="reference internal" href="#transition-dm"><span class="std std-ref">Restart DMRG transition reduced density matrix calculation</span></a>.</p>
<p>Example 7: state-averaged 2-particle transition density matrix between two A<sub>g</sub> states:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span> <span class="n">d2h</span>
<span class="n">orbitals</span> <span class="n">FCIDUMP</span>

<span class="n">nelec</span> <span class="mi">8</span>
<span class="n">spin</span> <span class="mi">0</span>
<span class="n">irrep</span> <span class="mi">1</span>
<span class="n">nroots</span> <span class="mi">2</span>
<span class="n">weights</span> <span class="mf">0.5</span> <span class="mf">0.5</span>

<span class="n">hf_occ</span> <span class="n">integral</span>
<span class="n">schedule</span> <span class="n">default</span>
<span class="n">maxM</span> <span class="mi">500</span>
<span class="n">maxiter</span> <span class="mi">30</span>

<span class="n">tran_twopdm</span>
</pre></div>
</div>
<p>The state-average 2-particle transition density matrix is stored in the file of
<a class="reference external" href="https://raw.githubusercontent.com/sanshar/Block/master/README_Examples/7/spatial_twopdm.1.0.txt">spatial_twopdm.1.0.txt</a>.</p>
<p>Example 8: state-specific 2-particle transition density matrix between two refined A<sub>g</sub> states:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span> <span class="n">d2h</span>
<span class="n">orbitals</span> <span class="n">FCIDUMP</span>

<span class="n">nelec</span> <span class="mi">8</span>
<span class="n">spin</span> <span class="mi">0</span>
<span class="n">irrep</span> <span class="mi">1</span>
<span class="n">nroots</span> <span class="mi">2</span>
<span class="n">weights</span> <span class="mf">0.5</span> <span class="mf">0.5</span>
<span class="n">onedot</span>
<span class="n">statespecific</span>

<span class="n">hf_occ</span> <span class="n">integral</span>
<span class="n">schedule</span> <span class="n">default</span>
<span class="n">maxM</span> <span class="mi">500</span>
<span class="n">maxiter</span> <span class="mi">30</span>

<span class="n">tran_twopdm</span>
</pre></div>
</div>
<p>The state-specific 2-particle transition density matrix is stored in the file of
<a class="reference external" href="https://raw.githubusercontent.com/sanshar/Block/master/README_Examples/8/spatial_twopdm.1.0.txt">spatial_twopdm.1.0.txt</a>.</p>
</div>
<div class="section" id="restart-dmrg-energy-calculation">
<h2>Restart DMRG energy calculation<a class="headerlink" href="#restart-dmrg-energy-calculation" title="Permalink to this headline">¶</a></h2>
<p>DMRG energy calculations can be restarted, using the <code class="docutils literal notranslate"><span class="pre">.tmp</span></code> scratch files generated in the previous calculation, by specifying the keyword <code class="docutils literal notranslate"><span class="pre">restart</span></code>.</p>
<p>Example 9: restart DMRG enegy calculation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span> <span class="n">d2h</span>
<span class="n">orbitals</span> <span class="n">FCIDUMP</span>

<span class="n">nelec</span> <span class="mi">8</span>
<span class="n">spin</span> <span class="mi">0</span>
<span class="n">irrep</span> <span class="mi">1</span>

<span class="n">hf_occ</span> <span class="n">integral</span>
<span class="n">schedule</span> <span class="n">default</span>
<span class="n">maxM</span> <span class="mi">500</span>
<span class="n">maxiter</span> <span class="mi">30</span>

<span class="n">restart</span>
</pre></div>
</div>
<p>Extract energies running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ grep &quot;Sweep Energy&quot; output.dat
M = 500     state = 0     Largest Discarded Weight = 9.792e-14  Sweep Energy = -75.7283469966
M = 500     state = 0     Largest Discarded Weight = 1.221e-15  Sweep Energy = -75.7283469966
M = 500     state = 0     Largest Discarded Weight = 4.441e-16  Sweep Energy = -75.7283469966
M = 500     state = 0     Largest Discarded Weight = 1.332e-15  Sweep Energy = -75.7283469966
M = 500     state = 0     Largest Discarded Weight = 4.441e-16  Sweep Energy = -75.7283469966
</pre></div>
</div>
</div>
<div class="section" id="restart-dmrg-n-particle-reduced-density-matrix-calculation">
<h2>Restart DMRG <em>n</em>-particle reduced density matrix calculation<a class="headerlink" href="#restart-dmrg-n-particle-reduced-density-matrix-calculation" title="Permalink to this headline">¶</a></h2>
<p>Up to 4-particle reduced density matrices can be calculated separately, by restarting from an existing DMRG wave function.
This requires the presence of the following scratch files with <code class="docutils literal notranslate"><span class="pre">.tmp</span></code> extension: “statefile”, “StateInfo”, “wave” and “Rotation”.</p>
<p>Example 10: restart DMRG 2-particle density matrix calculation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span> <span class="n">d2h</span>
<span class="n">orbitals</span> <span class="n">FCIDUMP</span>

<span class="n">nelec</span> <span class="mi">8</span>
<span class="n">spin</span> <span class="mi">0</span>
<span class="n">irrep</span> <span class="mi">1</span>

<span class="n">hf_occ</span> <span class="n">integral</span>
<span class="n">schedule</span> <span class="n">default</span>
<span class="n">maxM</span> <span class="mi">500</span>
<span class="n">maxiter</span> <span class="mi">30</span>

<span class="n">restart_twopdm</span>
</pre></div>
</div>
<p>The 2-particle density matrix is stored in the file of
<a class="reference external" href="https://raw.githubusercontent.com/sanshar/Block/master/README_Examples/10/spatial_twopdm.0.0.txt">spatial_twopdm.0.0.txt</a>.</p>
</div>
<div class="section" id="restart-dmrg-transition-reduced-density-matrix-calculation">
<span id="transition-dm"></span><h2>Restart DMRG transition reduced density matrix calculation<a class="headerlink" href="#restart-dmrg-transition-reduced-density-matrix-calculation" title="Permalink to this headline">¶</a></h2>
<p>A transition density matrix calculation can be carried out separately, by restarting from existing DMRG wave functions of bra and ket states.</p>
<p>Example 11: state-averaged 2-particle transition density matrix between bra and ket states belonging to the same irrep:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span> <span class="n">d2h</span>
<span class="n">orbitals</span> <span class="n">FCIDUMP</span>

<span class="n">nelec</span> <span class="mi">8</span>
<span class="n">spin</span> <span class="mi">0</span>
<span class="n">irrep</span> <span class="mi">1</span>
<span class="n">nroots</span> <span class="mi">2</span>
<span class="n">weights</span> <span class="mf">0.5</span> <span class="mf">0.5</span>

<span class="n">hf_occ</span> <span class="n">integral</span>
<span class="n">schedule</span> <span class="n">default</span>
<span class="n">maxM</span> <span class="mi">500</span>
<span class="n">maxiter</span> <span class="mi">30</span>

<span class="n">restart_tran_twopdm</span>
</pre></div>
</div>
<p>The 2-particle transition density matrix is stored in the file of
<a class="reference external" href="https://raw.githubusercontent.com/sanshar/Block/master/README_Examples/11/spatial_twopdm.1.0.txt">spatial_twopdm.1.0.txt</a>.</p>
<p>When bra and ket states belong to different irreps, the restart calculation takes a few steps in which the corresponding state-specific calculations are needed.</p>
<p>Example 12: 2-particle transition density matrix between A<sub>g</sub> (bra) and B<sub>3u</sub> (ket) states.</p>
<ul class="simple">
<li><p>Carry out state-specific calculations for bra and ket states separately, in different scratch directories of <code class="docutils literal notranslate"><span class="pre">scratch_bra</span></code> and <code class="docutils literal notranslate"><span class="pre">scratch_ket</span></code>, enabled by the keyword <code class="docutils literal notranslate"><span class="pre">scratch</span></code>. <code class="docutils literal notranslate"><span class="pre">BLOCK</span></code> labels bra and ket states as “state 1” and “state 0”, respectively.</p></li>
</ul>
<p>First, creat the scratch directory by <code class="docutils literal notranslate"><span class="pre">mkdir</span> <span class="pre">./scratch_bra</span></code> and calculate bra state as “state 1” belonging to <code class="docutils literal notranslate"><span class="pre">irrep</span> <span class="pre">2</span></code> of D<sub>2h</sub>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span> <span class="n">d2h</span>
<span class="n">orbitals</span> <span class="n">FCIDUMP</span>

<span class="n">nelec</span> <span class="mi">8</span>
<span class="n">spin</span> <span class="mi">0</span>
<span class="n">irrep</span> <span class="mi">2</span>

<span class="n">hf_occ</span> <span class="n">integral</span>
<span class="n">schedule</span> <span class="n">default</span>
<span class="n">maxM</span> <span class="mi">500</span>
<span class="n">maxiter</span> <span class="mi">30</span>

<span class="n">scratch</span> <span class="n">scratch_bra</span>
</pre></div>
</div>
<p>Second, creat the scratch directory by <code class="docutils literal notranslate"><span class="pre">mkdir</span> <span class="pre">./scratch_ket</span></code> and calculate ket state as “state 0” belonging to <code class="docutils literal notranslate"><span class="pre">irrep</span> <span class="pre">1</span></code> of D<sub>2h</sub>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span> <span class="n">d2h</span>
<span class="n">orbitals</span> <span class="n">FCIDUMP</span>

<span class="n">nelec</span> <span class="mi">8</span>
<span class="n">spin</span> <span class="mi">0</span>
<span class="n">irrep</span> <span class="mi">1</span>

<span class="n">hf_occ</span> <span class="n">integral</span>
<span class="n">schedule</span> <span class="n">default</span>
<span class="n">maxM</span> <span class="mi">500</span>
<span class="n">maxiter</span> <span class="mi">30</span>

<span class="n">scratch</span> <span class="n">scratch_ket</span>
</pre></div>
</div>
<p>In <code class="docutils literal notranslate"><span class="pre">./scratch_bra</span></code>, rename the resulting “statefile”, “wave”, “Rotation” scratch files by changing the numbers before the <code class="docutils literal notranslate"><span class="pre">.tmp</span></code> extension from “0” to “1”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ rename .0.tmp .1.tmp *.tmp
$ rename .state0.tmp .state1.tmp Rotation*.tmp
</pre></div>
</div>
<ul>
<li><p>Copy all “statefile”, “wave”, “Rotation” <code class="docutils literal notranslate"><span class="pre">.tmp</span></code> files from <code class="docutils literal notranslate"><span class="pre">scratch_bra</span></code> and <code class="docutils literal notranslate"><span class="pre">scratch_ket</span></code> directories to a separate directory <code class="docutils literal notranslate"><span class="pre">scratch_tran</span></code> for restarting calculation.</p></li>
<li><p>Restart a 2-particle transition density matrix calculation by adding the keyword <code class="docutils literal notranslate"><span class="pre">restart_tran_twopdm</span></code>. In addition <code class="docutils literal notranslate"><span class="pre">irrep</span> <span class="pre">2</span> <span class="pre">1</span></code> represents A<sub>g</sub> and B<sub>3u</sub> states for bra and ket, respectively:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span> <span class="n">d2h</span>
<span class="n">orbitals</span> <span class="n">FCIDUMP</span>

<span class="n">nelec</span> <span class="mi">8</span>
<span class="n">spin</span> <span class="mi">0</span>
<span class="n">irrep</span> <span class="mi">2</span> <span class="mi">1</span>
<span class="n">nroots</span> <span class="mi">2</span>

<span class="n">hf_occ</span> <span class="n">integral</span>
<span class="n">schedule</span> <span class="n">default</span>
<span class="n">maxM</span> <span class="mi">500</span>
<span class="n">maxiter</span> <span class="mi">30</span>

<span class="n">scratch</span> <span class="n">scratch_tran</span>
<span class="n">restart_tran_twopdm</span>
</pre></div>
</div>
</li>
</ul>
<p>The 2-particle transition density matrix is stored in the file of
<a class="reference external" href="https://raw.githubusercontent.com/sanshar/Block/master/README_Examples/12/spatial_twopdm.1.0.txt">spatial_twopdm.1.0.txt</a>.</p>
</div>
<div class="section" id="customize-sweep-schedule">
<h2>Customize sweep schedule<a class="headerlink" href="#customize-sweep-schedule" title="Permalink to this headline">¶</a></h2>
<p>The sweep schedule defines the renormalised states <em>M</em> used in successive DMRG sweeps.
For finer control over the sweeps, we recommend using a more advanced input.</p>
<p>Example 13: customized sweep schedule for the ground state of C<sub>2</sub> molecule:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span> <span class="n">d2h</span>
<span class="n">orbitals</span> <span class="n">FCIDUMP</span>

<span class="n">nelec</span> <span class="mi">8</span>
<span class="n">spin</span> <span class="mi">0</span>
<span class="n">irrep</span> <span class="mi">1</span>

<span class="n">hf_occ</span> <span class="n">integral</span>
<span class="n">schedule</span>
 <span class="mi">0</span>  <span class="mi">100</span>  <span class="mf">1e-6</span>  <span class="mf">1e-6</span>
 <span class="mi">4</span>  <span class="mi">250</span>  <span class="mf">1e-6</span>  <span class="mf">1e-6</span>
 <span class="mi">8</span>  <span class="mi">400</span>  <span class="mf">1e-6</span>  <span class="mf">1e-6</span>
 <span class="mi">10</span> <span class="mi">600</span>  <span class="mf">1e-8</span>  <span class="mf">1e-8</span>
 <span class="mi">12</span> <span class="mi">800</span>  <span class="mf">1e-10</span> <span class="mf">1e-10</span>
 <span class="mi">14</span> <span class="mi">800</span>  <span class="mf">1e-10</span> <span class="mf">0.0</span>
<span class="n">end</span>
<span class="n">twodot_to_onedot</span> <span class="mi">16</span>
<span class="n">maxiter</span> <span class="mi">100</span>
<span class="n">sweep_tol</span> <span class="mf">1e-9</span>
</pre></div>
</div>
<p>Extract energies running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ grep &quot;Sweep Energy&quot; output.dat
M = 100     state = 0     Largest Discarded Weight = 3.960e-05  Sweep Energy = -75.6814569486
M = 100     state = 0     Largest Discarded Weight = 8.248e-05  Sweep Energy = -75.7162162063
M = 100     state = 0     Largest Discarded Weight = 1.299e-04  Sweep Energy = -75.7197142506
M = 100     state = 0     Largest Discarded Weight = 1.405e-04  Sweep Energy = -75.7207575174
M = 250     state = 0     Largest Discarded Weight = 3.124e-06  Sweep Energy = -75.7247598640
M = 250     state = 0     Largest Discarded Weight = 2.578e-05  Sweep Energy = -75.7262894828
M = 250     state = 0     Largest Discarded Weight = 2.747e-05  Sweep Energy = -75.7266725035
M = 250     state = 0     Largest Discarded Weight = 3.358e-05  Sweep Energy = -75.7269909475
M = 400     state = 0     Largest Discarded Weight = 2.523e-06  Sweep Energy = -75.7273900910
M = 400     state = 0     Largest Discarded Weight = 8.012e-06  Sweep Energy = -75.7276294430
M = 600     state = 0     Largest Discarded Weight = 7.906e-07  Sweep Energy = -75.7279563319
M = 600     state = 0     Largest Discarded Weight = 2.633e-06  Sweep Energy = -75.7282799011
M = 800     state = 0     Largest Discarded Weight = 5.453e-07  Sweep Energy = -75.7284217562
M = 800     state = 0     Largest Discarded Weight = 1.075e-06  Sweep Energy = -75.7284897369
M = 800     state = 0     Largest Discarded Weight = 1.097e-06  Sweep Energy = -75.7284954448
M = 800     state = 0     Largest Discarded Weight = 1.141e-06  Sweep Energy = -75.7285020635
M = 800     state = 0     Largest Discarded Weight = 1.774e-12  Sweep Energy = -75.7284957831
M = 800     state = 0     Largest Discarded Weight = 1.998e-15  Sweep Energy = -75.7284962879
M = 800     state = 0     Largest Discarded Weight = 1.665e-15  Sweep Energy = -75.7284964775
M = 800     state = 0     Largest Discarded Weight = 8.882e-16  Sweep Energy = -75.7284965570
M = 800     state = 0     Largest Discarded Weight = 9.925e-14  Sweep Energy = -75.7284966051
M = 800     state = 0     Largest Discarded Weight = 9.992e-16  Sweep Energy = -75.7284966429
M = 800     state = 0     Largest Discarded Weight = 4.441e-16  Sweep Energy = -75.7284966756
M = 800     state = 0     Largest Discarded Weight = 9.992e-16  Sweep Energy = -75.7284967027
M = 800     state = 0     Largest Discarded Weight = 9.837e-14  Sweep Energy = -75.7284967230
M = 800     state = 0     Largest Discarded Weight = 5.551e-16  Sweep Energy = -75.7284967374
M = 800     state = 0     Largest Discarded Weight = 9.714e-14  Sweep Energy = -75.7284967475
M = 800     state = 0     Largest Discarded Weight = 6.661e-16  Sweep Energy = -75.7284967548
M = 800     state = 0     Largest Discarded Weight = 9.781e-14  Sweep Energy = -75.7284967604
M = 800     state = 0     Largest Discarded Weight = 8.882e-16  Sweep Energy = -75.7284967649
M = 800     state = 0     Largest Discarded Weight = 1.665e-15  Sweep Energy = -75.7284967687
M = 800     state = 0     Largest Discarded Weight = 1.221e-15  Sweep Energy = -75.7284967719
M = 800     state = 0     Largest Discarded Weight = 1.110e-15  Sweep Energy = -75.7284967748
M = 800     state = 0     Largest Discarded Weight = 1.110e-15  Sweep Energy = -75.7284967775
M = 800     state = 0     Largest Discarded Weight = 3.331e-16  Sweep Energy = -75.7284967800
M = 800     state = 0     Largest Discarded Weight = 7.772e-16  Sweep Energy = -75.7284967824
M = 800     state = 0     Largest Discarded Weight = 1.443e-15  Sweep Energy = -75.7284967849
M = 800     state = 0     Largest Discarded Weight = 1.665e-15  Sweep Energy = -75.7284967873
M = 800     state = 0     Largest Discarded Weight = 4.441e-16  Sweep Energy = -75.7284967898
M = 800     state = 0     Largest Discarded Weight = 8.882e-16  Sweep Energy = -75.7284967922
M = 800     state = 0     Largest Discarded Weight = 2.109e-15  Sweep Energy = -75.7284967947
M = 800     state = 0     Largest Discarded Weight = 6.661e-16  Sweep Energy = -75.7284967971
M = 800     state = 0     Largest Discarded Weight = 8.882e-16  Sweep Energy = -75.7284967994
M = 800     state = 0     Largest Discarded Weight = 1.443e-15  Sweep Energy = -75.7284968017
M = 800     state = 0     Largest Discarded Weight = 2.220e-16  Sweep Energy = -75.7284968038
M = 800     state = 0     Largest Discarded Weight = 1.332e-15  Sweep Energy = -75.7284968058
M = 800     state = 0     Largest Discarded Weight = 1.554e-15  Sweep Energy = -75.7284968077
M = 800     state = 0     Largest Discarded Weight = 1.221e-15  Sweep Energy = -75.7284968095
M = 800     state = 0     Largest Discarded Weight = 5.551e-16  Sweep Energy = -75.7284968112
M = 800     state = 0     Largest Discarded Weight = 4.441e-16  Sweep Energy = -75.7284968128
M = 800     state = 0     Largest Discarded Weight = 9.992e-16  Sweep Energy = -75.7284968142
M = 800     state = 0     Largest Discarded Weight = 4.441e-16  Sweep Energy = -75.7284968156
M = 800     state = 0     Largest Discarded Weight = 8.882e-16  Sweep Energy = -75.7284968168
M = 800     state = 0     Largest Discarded Weight = 6.661e-16  Sweep Energy = -75.7284968179
M = 800     state = 0     Largest Discarded Weight = 6.661e-16  Sweep Energy = -75.7284968189
M = 800     state = 0     Largest Discarded Weight = 8.882e-16  Sweep Energy = -75.7284968198
M = 800     state = 0     Largest Discarded Weight = 1.887e-15  Sweep Energy = -75.7284968206
M = 800     state = 0     Largest Discarded Weight = 1.887e-15  Sweep Energy = -75.7284968213
M = 800     state = 0     Largest Discarded Weight = 6.661e-16  Sweep Energy = -75.7284968219
M = 800     state = 0     Largest Discarded Weight = 7.772e-16  Sweep Energy = -75.7284968225
M = 800     state = 0     Largest Discarded Weight = 1.554e-15  Sweep Energy = -75.7284968230
M = 800     state = 0     Largest Discarded Weight = 6.661e-16  Sweep Energy = -75.7284968234
M = 800     state = 0     Largest Discarded Weight = 1.887e-15  Sweep Energy = -75.7284968238
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">twodot_to_onedot</span></code> specifies the sweep at which the switch is made
from a twodot to a onedot algorithm.
<code class="docutils literal notranslate"><span class="pre">maxiter</span></code> gives the maximum number of sweep iterations to be performed.
<code class="docutils literal notranslate"><span class="pre">sweep_tol</span></code> gives the final tolerance on the DMRG energy,
and is analogous to an energy convergence threshold in other quantum chemistry methods.</p>
<p>In Example 13 between <code class="docutils literal notranslate"><span class="pre">schedule</span></code> and <code class="docutils literal notranslate"><span class="pre">end</span></code> each line has four values corresponding to <em>sweep_iteration</em>,  <em>M</em>, <em>Davidson_tolerance</em> and <em>Noise</em>, respectively.
<em>sweep_iteration</em> is the sweep iteration in which the number of renormalized states <em>M</em>,
the tolerance of Davidson algorithm and the perturbative noise should take effect.</p>
</div>
<div class="section" id="sweep-energy-extrapolation">
<h2>Sweep energy extrapolation<a class="headerlink" href="#sweep-energy-extrapolation" title="Permalink to this headline">¶</a></h2>
<p>In practice the sweep energy converges almost linearly as a function of the “discarded weight”.
Therefore it is convenient to use the “discarded weight” quantity as an estimate of the error of the DMRG calculation.
It is recommended to use “twodot” algorithm for energy extrapolation
since the “twodot” DMRG wavefunction provides additional variational freedom over the “onedot” DMRG wavefunction.
A strong deviation from a linear function (e.g. a plateau behaviour followed by a sudden drop of the
energy as a function of discarded weight) indicates that the DMRG was stuck in a local minimum.</p>
<p>Example 14: the ground state of C<sub>2</sub>, cc-pVDZ basis and customized sweep schedule.</p>
<p>Prepare <code class="docutils literal notranslate"><span class="pre">input.dat</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span> <span class="n">d2h</span>
<span class="n">orbitals</span> <span class="n">FCIDUMP</span>

<span class="n">nelec</span> <span class="mi">8</span>
<span class="n">spin</span> <span class="mi">0</span>
<span class="n">irrep</span> <span class="mi">1</span>

<span class="n">hf_occ</span> <span class="n">integral</span>
<span class="n">schedule</span>
<span class="mi">0</span>   <span class="mi">250</span>    <span class="mf">1.0e-5</span>  <span class="mf">1.0e-4</span>
<span class="mi">8</span>   <span class="mi">500</span>    <span class="mf">1.0e-6</span>  <span class="mf">1.0e-5</span>
<span class="mi">10</span>  <span class="mi">500</span>    <span class="mf">1.0e-7</span>  <span class="mf">1.0e-6</span>
<span class="mi">12</span>  <span class="mi">1000</span>   <span class="mf">1.0e-7</span>  <span class="mf">1.0e-7</span>
<span class="mi">16</span>  <span class="mi">1500</span>   <span class="mf">1.0e-7</span>  <span class="mf">1.0e-7</span>
<span class="mi">20</span>  <span class="mi">2000</span>   <span class="mf">1.0e-7</span>  <span class="mf">1.0e-7</span>
<span class="mi">24</span>  <span class="mi">2500</span>   <span class="mf">1.0e-7</span>  <span class="mf">1.0e-7</span>
<span class="mi">28</span>  <span class="mi">3000</span>   <span class="mf">1.0e-7</span>  <span class="mf">1.0e-7</span>
<span class="mi">32</span>  <span class="mi">3500</span>   <span class="mf">1.0e-7</span>  <span class="mf">1.0e-7</span>
<span class="mi">36</span>  <span class="mi">4000</span>   <span class="mf">1.0e-7</span>  <span class="mf">1.0e-7</span>
<span class="mi">40</span>  <span class="mi">4500</span>   <span class="mf">1.0e-7</span>  <span class="mf">0.0</span>
<span class="n">end</span>
<span class="n">maxiter</span> <span class="mi">100</span>
<span class="n">sweep_tol</span> <span class="mf">1e-7</span>
</pre></div>
</div>
<p>Then run <code class="docutils literal notranslate"><span class="pre">BLOCK</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ block.spin_adapted input.dat &gt; output.dat
</pre></div>
</div>
<p>When the calculation is done, extract the sweep energies from <code class="docutils literal notranslate"><span class="pre">output.dat</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ grep &quot;Sweep Energy&quot; output.dat
M = 250     state = 0     Largest Discarded Weight = 2.601e-05  Sweep Energy = -75.7044175965
M = 250     state = 0     Largest Discarded Weight = 4.145e-05  Sweep Energy = -75.7253836704
M = 250     state = 0     Largest Discarded Weight = 5.085e-05  Sweep Energy = -75.7268081556
M = 250     state = 0     Largest Discarded Weight = 5.615e-05  Sweep Energy = -75.7271779408
M = 250     state = 0     Largest Discarded Weight = 5.769e-05  Sweep Energy = -75.7272098184
M = 250     state = 0     Largest Discarded Weight = 5.568e-05  Sweep Energy = -75.7273283072
M = 250     state = 0     Largest Discarded Weight = 5.712e-05  Sweep Energy = -75.7273267274
M = 250     state = 0     Largest Discarded Weight = 5.517e-05  Sweep Energy = -75.7273439451
M = 500     state = 0     Largest Discarded Weight = 2.342e-06  Sweep Energy = -75.7279482411
M = 500     state = 0     Largest Discarded Weight = 6.584e-06  Sweep Energy = -75.7282540320
M = 500     state = 0     Largest Discarded Weight = 4.624e-06  Sweep Energy = -75.7283335685
M = 500     state = 0     Largest Discarded Weight = 5.559e-06  Sweep Energy = -75.7283761594
M = 1000    state = 0     Largest Discarded Weight = 6.188e-08  Sweep Energy = -75.7284812770
M = 1000    state = 0     Largest Discarded Weight = 5.381e-07  Sweep Energy = -75.7285301147
M = 1000    state = 0     Largest Discarded Weight = 5.417e-07  Sweep Energy = -75.7285372992
M = 1000    state = 0     Largest Discarded Weight = 5.967e-07  Sweep Energy = -75.7285405838
M = 1500    state = 0     Largest Discarded Weight = 3.754e-08  Sweep Energy = -75.7285498358
M = 1500    state = 0     Largest Discarded Weight = 1.081e-07  Sweep Energy = -75.7285529289
M = 1500    state = 0     Largest Discarded Weight = 8.351e-08  Sweep Energy = -75.7285532135
M = 1500    state = 0     Largest Discarded Weight = 1.090e-07  Sweep Energy = -75.7285536128
M = 2000    state = 0     Largest Discarded Weight = 1.439e-08  Sweep Energy = -75.7285550762
M = 2000    state = 0     Largest Discarded Weight = 3.133e-08  Sweep Energy = -75.7285555795
M = 2000    state = 0     Largest Discarded Weight = 2.453e-08  Sweep Energy = -75.7285555897
M = 2000    state = 0     Largest Discarded Weight = 3.194e-08  Sweep Energy = -75.7285556424
M = 2500    state = 0     Largest Discarded Weight = 6.035e-09  Sweep Energy = -75.7285560031
M = 2500    state = 0     Largest Discarded Weight = 1.047e-08  Sweep Energy = -75.7285561192
M = 2500    state = 0     Largest Discarded Weight = 8.973e-09  Sweep Energy = -75.7285561321
M = 2500    state = 0     Largest Discarded Weight = 1.026e-08  Sweep Energy = -75.7285561411
M = 3000    state = 0     Largest Discarded Weight = 3.163e-09  Sweep Energy = -75.7285562237
M = 3000    state = 0     Largest Discarded Weight = 4.145e-09  Sweep Energy = -75.7285562440
M = 3000    state = 0     Largest Discarded Weight = 3.361e-09  Sweep Energy = -75.7285562445
M = 3000    state = 0     Largest Discarded Weight = 4.119e-09  Sweep Energy = -75.7285562494
M = 3500    state = 0     Largest Discarded Weight = 1.743e-09  Sweep Energy = -75.7285562638
M = 3500    state = 0     Largest Discarded Weight = 1.691e-09  Sweep Energy = -75.7285562675
M = 3500    state = 0     Largest Discarded Weight = 1.605e-09  Sweep Energy = -75.7285562590
M = 3500    state = 0     Largest Discarded Weight = 1.288e-09  Sweep Energy = -75.7285562542
M = 4000    state = 0     Largest Discarded Weight = 9.977e-10  Sweep Energy = -75.7285562726
M = 4000    state = 0     Largest Discarded Weight = 8.928e-10  Sweep Energy = -75.7285562816
M = 4000    state = 0     Largest Discarded Weight = 7.882e-10  Sweep Energy = -75.7285562783
M = 4000    state = 0     Largest Discarded Weight = 8.000e-10  Sweep Energy = -75.7285562771
M = 4500    state = 0     Largest Discarded Weight = 8.562e-13  Sweep Energy = -75.7285562762
M = 4500    state = 0     Largest Discarded Weight = 1.733e-13  Sweep Energy = -75.7285562762
M = 4500    state = 0     Largest Discarded Weight = 4.441e-16  Sweep Energy = -75.7285562762
M = 4500    state = 0     Largest Discarded Weight = 1.998e-15  Sweep Energy = -75.7285562762
M = 4500    state = 0     Largest Discarded Weight = 7.772e-16  Sweep Energy = -75.7285562762
</pre></div>
</div>
<p>Energy extrapolation:</p>
<div class="figure align-left" id="id1">
<a class="reference internal image-reference" href="_images/c2_energy.png"><img alt="_images/c2_energy.png" src="_images/c2_energy.png" style="width: 640.0px; height: 512.0px;" /></a>
<p class="caption"><span class="caption-text">Starting from <em>M=500</em>, use the largest discarded weights and associated sweep energies in the last sweep iteration of each <em>M</em> to make linear regression (see the figure above). The extrapolated DMRG sweep energy is -75.728557 a.u.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="further-reading">
<h2>Further Reading<a class="headerlink" href="#further-reading" title="Permalink to this headline">¶</a></h2>
<p>Some practical questions are often asked such as,</p>
<ul class="simple">
<li><p>what sort of molecules can the DMRG be practically applied to?</p></li>
<li><p>what sort of accuracies can be obtained and at what cost? What are the typical sizes of systems (e.g. number
of active orbitals) that can be treated with practical computational resources?</p></li>
<li><p>how do we reason about the accuracy of DMRG calculations for dirent molecules?</p></li>
<li><p>how is a DMRG calculation best specified (e.g. in terms of starting orbitals and their order)?</p></li>
</ul>
<p>We provide answers in the following paper from both theoretical reasoning and numerical calculation by applying the DMRG
to a representative set of molecules.
The calculations we describe therein are all run in a completely black-box fashion using the default settings of our <code class="docutils literal notranslate"><span class="pre">Block</span></code> code.</p>
<ul class="simple">
<li><ol class="upperalpha simple" start="18">
<li><p>Olivares-Amaya, W. Hu, N. Nakatani, S. Sharma, J. Yang and G. K.-L. Chan, J. Chem. Phys. 142, 034102 (2015).</p></li>
</ol>
</li>
</ul>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Block program as a standalone solver</a><ul>
<li><a class="reference internal" href="#molecular-symmetry">Molecular symmetry</a></li>
<li><a class="reference internal" href="#state-wavefunction">State wavefunction</a></li>
<li><a class="reference internal" href="#state-averaged-calculation">State-averaged calculation</a></li>
<li><a class="reference internal" href="#state-specific-calculation">State-specific calculation</a></li>
<li><a class="reference internal" href="#n-particle-reduced-density-matrix"><em>n</em>-particle reduced density matrix</a></li>
<li><a class="reference internal" href="#and-2-particle-transition-reduced-density-matrix">1- and 2-particle transition reduced density matrix</a></li>
<li><a class="reference internal" href="#restart-dmrg-energy-calculation">Restart DMRG energy calculation</a></li>
<li><a class="reference internal" href="#restart-dmrg-n-particle-reduced-density-matrix-calculation">Restart DMRG <em>n</em>-particle reduced density matrix calculation</a></li>
<li><a class="reference internal" href="#restart-dmrg-transition-reduced-density-matrix-calculation">Restart DMRG transition reduced density matrix calculation</a></li>
<li><a class="reference internal" href="#customize-sweep-schedule">Customize sweep schedule</a></li>
<li><a class="reference internal" href="#sweep-energy-extrapolation">Sweep energy extrapolation</a></li>
<li><a class="reference internal" href="#further-reading">Further Reading</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="with-pyscf.html"
                        title="previous chapter">DMRG for electronic structure calculations</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="keywords.html"
                        title="next chapter">Keywords</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/examples.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="keywords.html" title="Keywords"
             >next</a></li>
        <li class="right" >
          <a href="with-pyscf.html" title="DMRG for electronic structure calculations"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">BLOCK 1.5.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Block program as a standalone solver</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, Garnet Kin-Lic Chan.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.1.1.
    </div>
  </body>
</html>